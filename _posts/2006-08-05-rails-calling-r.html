---
layout: post
title: 'Rails: Calling render() outside your Controllers'
published: true
category:
- rails
---
<p>I found myself needing to render a .rxml template from my Model today (Ok, stop the MVC preach already...) anyways.. found a few <a href="http://lists.rubyonrails.org/pipermail/rails/2006-May/043659.html">deadends</a>, but finally got down to use method_missing to see what's needed by ActionViewer::Base. Not sure if there's an easier way... </p><p>&nbsp;</p><pre><span class="comment"># </span><br /><span class="comment"># lib/render_anywhere.rb</span><br /><span class="comment"># </span><br /><span class="comment"># Render templates outside of a controller or view.</span><br /><span class="comment"># </span><br /><span class="comment"># Simply mixin this module to your existing class, for example:</span><br /><span class="comment"># </span><br /><span class="comment">#   class MyTemplater &lt; ActiveRecord::Base</span><br /><span class="comment">#     include RenderAnywhere</span><br /><span class="comment"># </span><br /><span class="comment"># And you can use render() method that works the same as ActionView::Base#render</span><br /><span class="comment"># </span><br /><span class="comment">#   obj = MyTemplater.new</span><br /><span class="comment">#   obj.html = obj.render :file =&gt; '/shared/header'</span><br /><span class="comment"># </span><br /><span class="comment"># </span><br /><span class="keyword">module </span><span class="module">RenderAnywhere</span><br />    <br />    <span class="keyword">class </span><span class="class">DummyController</span><br />        <span class="keyword">def </span><span class="method">logger</span><br />            <span class="constant">RAILS_DEFAULT_LOGGER</span><br />        <span class="keyword">end</span><br />        <span class="keyword">def </span><span class="method">headers</span><br />            <span class="punct">{}</span><br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br />    <br />    <span class="keyword">def </span><span class="method">render</span><span class="punct">(</span><span class="ident">options</span><span class="punct">,</span> <span class="ident">assigns</span> <span class="punct">=</span> <span class="punct">{})</span><br />        <span class="ident">viewer</span> <span class="punct">=</span> <span class="constant">ActionView</span><span class="punct">::</span><span class="constant">Base</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="constant">Rails</span><span class="punct">::</span><span class="constant">Configuration</span><span class="punct">.</span><span class="ident">new</span><span class="punct">.</span><span class="ident">view_path</span><span class="punct">,</span> <span class="ident">assigns</span><span class="punct">,</span> <span class="constant">DummyController</span><span class="punct">.</span><span class="ident">new</span><span class="punct">)</span><br />        <span class="ident">viewer</span><span class="punct">.</span><span class="ident">render</span> <span class="ident">options</span><br />    <span class="keyword">end</span><br />    <br />    <span class="keyword">def </span><span class="method">template_exists?</span><span class="punct">(</span><span class="ident">path</span><span class="punct">,</span> <span class="ident">assigns</span> <span class="punct">=</span> <span class="punct">{})</span><br />        <span class="ident">viewer</span> <span class="punct">=</span> <span class="constant">ActionView</span><span class="punct">::</span><span class="constant">Base</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="constant">Rails</span><span class="punct">::</span><span class="constant">Configuration</span><span class="punct">.</span><span class="ident">new</span><span class="punct">.</span><span class="ident">view_path</span><span class="punct">,</span> <span class="ident">assigns</span><span class="punct">,</span> <span class="constant">DummyController</span><span class="punct">.</span><span class="ident">new</span><span class="punct">)</span><br />        <span class="ident">viewer</span><span class="punct">.</span><span class="ident">pick_template_extension</span><span class="punct">(</span><span class="ident">path</span><span class="punct">)</span> <span class="keyword">rescue</span> <span class="constant">false</span><br />    <span class="keyword">end</span><br /><span class="keyword">end</span><br /><br /></pre><p>Hope this is helpful to someone&nbsp;</p>
