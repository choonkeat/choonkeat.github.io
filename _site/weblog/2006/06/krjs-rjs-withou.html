<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>KRJS: RJS without messing the Views | The Devel!</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="KRJS: RJS without messing the Views" />
<meta name="author" content="choonkeat" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="RJS is great and awesome. I use it quite regularly now. With RJS, I don&#39;t have to deal with which parts of the page to update in the rhtml files - I get to decide whilst in my controller using the nice and elegant render :update. Sweet. But part of me wished I didn&#39;t have to even decide which page elements are to be ajaxified. I&#39;d wish I could more easily enable a link, form or button to make ajax calls without going back and touching my html... Oh well. Introducing the KRJS plugin, with less than 60 lines of patch to Rails&#39; ActionPack itself (which probably means bugs are aplenty, would slow production sites to a crawl, and that its fresh from the oven too) To see KRJS in action (so what does it do?), generate a blank controller and index action: ./script/generate controller Sample index Give it a decent layout (include javascripts) by creating the file app/views/layouts/sample.rhtml &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;%= javascript_include_tag :defaults %&gt; &lt;/head&gt; &lt;body&gt; &lt;%= @content_for_layout %&gt; &lt;/body&gt; &lt;/html&gt; Create a sample form: &lt;%= form_tag({:action =&gt; &#39;submit&#39;}, {:id =&gt; &#39;form&#39;}) %&gt; &lt;%= text_field &#39;account&#39;, &#39;login&#39;, :id =&gt; &#39;account-new-login&#39; %&gt;&lt;br /&gt; &lt;%= submit_tag &#39;Login&#39; %&gt; &lt;%= end_form_tag %&gt; This will be the last time we&#39;re touch the Views. If you visit the page now, you should see a simple form. This is the most basic Rails app. It will be our mickey mouse app for this session: Clicking on Login leads you to an even simpler error page: This is because we didn&#39;t have any code to handle the form submit. Don&#39;t let that stop us web2.0-ers, let&#39;s ajaxify it anyways! First, install the KRJS plugin ./script/plugin install http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/and restart your server. Now, try to view the page, and click on the Login button.... same error page. Good! That means KRJS didn&#39;t mess up the original app. Now let&#39;s add a new method into the controller, app/controllers/sample_controller.rb def on_form_submit render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, and click on Login As you can see, the form has become ajaxified - to update the page instead of sending the browser to a new location - by merely adding a new corresponding method in the controller! How about adding this to the controller: &nbsp; def on_account_login_blur render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, type something into the textfield and TAB away from the field: Yea, KRJS registers onBlur events as well. In fact, it&#39;ll register onClick, onSubmit, onWatever, onYouwant because it doesn&#39;t really care. All that matters is your HTML element&#39;s ID attribute. KRJS currently identifies xhr actions by naming conventions, hence it will probably be most convenient to be used with dashed_dom_id plugin.&nbsp; Go ahead, give it a spin. I&#39;m going to sleep.. hope I don&#39;t wake into a world of horror... [Updated plugin links]&nbsp;" />
<meta property="og:description" content="RJS is great and awesome. I use it quite regularly now. With RJS, I don&#39;t have to deal with which parts of the page to update in the rhtml files - I get to decide whilst in my controller using the nice and elegant render :update. Sweet. But part of me wished I didn&#39;t have to even decide which page elements are to be ajaxified. I&#39;d wish I could more easily enable a link, form or button to make ajax calls without going back and touching my html... Oh well. Introducing the KRJS plugin, with less than 60 lines of patch to Rails&#39; ActionPack itself (which probably means bugs are aplenty, would slow production sites to a crawl, and that its fresh from the oven too) To see KRJS in action (so what does it do?), generate a blank controller and index action: ./script/generate controller Sample index Give it a decent layout (include javascripts) by creating the file app/views/layouts/sample.rhtml &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;%= javascript_include_tag :defaults %&gt; &lt;/head&gt; &lt;body&gt; &lt;%= @content_for_layout %&gt; &lt;/body&gt; &lt;/html&gt; Create a sample form: &lt;%= form_tag({:action =&gt; &#39;submit&#39;}, {:id =&gt; &#39;form&#39;}) %&gt; &lt;%= text_field &#39;account&#39;, &#39;login&#39;, :id =&gt; &#39;account-new-login&#39; %&gt;&lt;br /&gt; &lt;%= submit_tag &#39;Login&#39; %&gt; &lt;%= end_form_tag %&gt; This will be the last time we&#39;re touch the Views. If you visit the page now, you should see a simple form. This is the most basic Rails app. It will be our mickey mouse app for this session: Clicking on Login leads you to an even simpler error page: This is because we didn&#39;t have any code to handle the form submit. Don&#39;t let that stop us web2.0-ers, let&#39;s ajaxify it anyways! First, install the KRJS plugin ./script/plugin install http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/and restart your server. Now, try to view the page, and click on the Login button.... same error page. Good! That means KRJS didn&#39;t mess up the original app. Now let&#39;s add a new method into the controller, app/controllers/sample_controller.rb def on_form_submit render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, and click on Login As you can see, the form has become ajaxified - to update the page instead of sending the browser to a new location - by merely adding a new corresponding method in the controller! How about adding this to the controller: &nbsp; def on_account_login_blur render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, type something into the textfield and TAB away from the field: Yea, KRJS registers onBlur events as well. In fact, it&#39;ll register onClick, onSubmit, onWatever, onYouwant because it doesn&#39;t really care. All that matters is your HTML element&#39;s ID attribute. KRJS currently identifies xhr actions by naming conventions, hence it will probably be most convenient to be used with dashed_dom_id plugin.&nbsp; Go ahead, give it a spin. I&#39;m going to sleep.. hope I don&#39;t wake into a world of horror... [Updated plugin links]&nbsp;" />
<link rel="canonical" href="http://localhost:4000/weblog/2006/06/krjs-rjs-withou.html" />
<meta property="og:url" content="http://localhost:4000/weblog/2006/06/krjs-rjs-withou.html" />
<meta property="og:site_name" content="The Devel!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-06-12T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"KRJS: RJS without messing the Views","dateModified":"2006-06-12T00:00:00+08:00","datePublished":"2006-06-12T00:00:00+08:00","author":{"@type":"Person","name":"choonkeat"},"description":"RJS is great and awesome. I use it quite regularly now. With RJS, I don&#39;t have to deal with which parts of the page to update in the rhtml files - I get to decide whilst in my controller using the nice and elegant render :update. Sweet. But part of me wished I didn&#39;t have to even decide which page elements are to be ajaxified. I&#39;d wish I could more easily enable a link, form or button to make ajax calls without going back and touching my html... Oh well. Introducing the KRJS plugin, with less than 60 lines of patch to Rails&#39; ActionPack itself (which probably means bugs are aplenty, would slow production sites to a crawl, and that its fresh from the oven too) To see KRJS in action (so what does it do?), generate a blank controller and index action: ./script/generate controller Sample index Give it a decent layout (include javascripts) by creating the file app/views/layouts/sample.rhtml &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;%= javascript_include_tag :defaults %&gt; &lt;/head&gt; &lt;body&gt; &lt;%= @content_for_layout %&gt; &lt;/body&gt; &lt;/html&gt; Create a sample form: &lt;%= form_tag({:action =&gt; &#39;submit&#39;}, {:id =&gt; &#39;form&#39;}) %&gt; &lt;%= text_field &#39;account&#39;, &#39;login&#39;, :id =&gt; &#39;account-new-login&#39; %&gt;&lt;br /&gt; &lt;%= submit_tag &#39;Login&#39; %&gt; &lt;%= end_form_tag %&gt; This will be the last time we&#39;re touch the Views. If you visit the page now, you should see a simple form. This is the most basic Rails app. It will be our mickey mouse app for this session: Clicking on Login leads you to an even simpler error page: This is because we didn&#39;t have any code to handle the form submit. Don&#39;t let that stop us web2.0-ers, let&#39;s ajaxify it anyways! First, install the KRJS plugin ./script/plugin install http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/and restart your server. Now, try to view the page, and click on the Login button.... same error page. Good! That means KRJS didn&#39;t mess up the original app. Now let&#39;s add a new method into the controller, app/controllers/sample_controller.rb def on_form_submit render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, and click on Login As you can see, the form has become ajaxified - to update the page instead of sending the browser to a new location - by merely adding a new corresponding method in the controller! How about adding this to the controller: &nbsp; def on_account_login_blur render :update do |page| page.insert_html :after, &#39;form&#39;, CGI.escapeHTML(params.inspect) end end &nbsp; Refresh the page, type something into the textfield and TAB away from the field: Yea, KRJS registers onBlur events as well. In fact, it&#39;ll register onClick, onSubmit, onWatever, onYouwant because it doesn&#39;t really care. All that matters is your HTML element&#39;s ID attribute. KRJS currently identifies xhr actions by naming conventions, hence it will probably be most convenient to be used with dashed_dom_id plugin.&nbsp; Go ahead, give it a spin. I&#39;m going to sleep.. hope I don&#39;t wake into a world of horror... [Updated plugin links]&nbsp;","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/weblog/2006/06/krjs-rjs-withou.html"},"url":"http://localhost:4000/weblog/2006/06/krjs-rjs-withou.html","@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The Devel!" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The Devel!</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">KRJS: RJS without messing the Views</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-06-12T00:00:00+08:00" itemprop="datePublished">Jun 12, 2006
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>   <p>RJS is great and awesome. I use it quite regularly now. With RJS, I don't have to deal with <em>which parts of the page to update</em> in the rhtml files - I get to decide whilst in my controller using the nice and elegant <a href="http://codefluency.com/articles/2006/05/27/rails-views-render-update-not-rjs/">render :update</a>. Sweet. </p>             <p>But part of me wished I didn't have to even decide <em>which page elements are to be ajaxified</em>. I'd wish I could more easily enable a link, form or button to make ajax calls without going back and touching my html... <br />       </p>             <p>Oh well. </p>             <p>Introducing the <a href="http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/">KRJS plugin</a>, with less than 60 lines of patch to Rails' ActionPack itself (which probably means bugs are aplenty, would slow production sites to a crawl, and that its fresh from the oven too)</p>             <p>To see KRJS in action (<em>so what does it do?</em>), generate a blank controller and index action:<br />   </p>     <pre><font color="#990000">.</font>/script/generate controller Sample index</pre>   <p>Give it a decent layout (include javascripts) by creating the file app/views/layouts/sample.rhtml<br />   </p>     <pre><font color="#990000">&lt;</font><font color="#990000">!</font>DOCTYPE html PUBLIC <font color="#ff0000">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</font><br />     <font color="#ff0000">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</font><font color="#990000">&gt;</font><br />   <font color="#ff0000">&lt;html&gt;</font><br />   <font color="#ff0000">&lt;head&gt;</font><br />     <font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> javascript_include_tag <font color="#990000">:</font>defaults <font color="#990000">%</font><font color="#990000">&gt;</font><br />   <font color="#ff0000">&lt;/head&gt;</font><br />   <font color="#ff0000">&lt;body&gt;</font><br />   <font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> <font color="#009900">@content_for_layout</font> <font color="#990000">%</font><font color="#990000">&gt;</font><br />   <font color="#ff0000">&lt;/body&gt;</font><br />   <font color="#ff0000">&lt;/html&gt;</font> </pre>           <p>Create a sample form: <br />   </p>     <pre><font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> <strong><font color="#000000">form_tag</font></strong><font color="#990000">(</font><font color="#ff0000">{</font><font color="#990000">:</font>action <font color="#990000">=</font><font color="#990000">&gt;</font> <font color="#ff0000">'submit'</font><font color="#ff0000">}</font><font color="#990000">,</font> <font color="#ff0000">{</font><font color="#990000">:</font>id <font color="#990000">=</font><font color="#990000">&gt;</font> <font color="#ff0000">'form'</font><font color="#ff0000">}</font><font color="#990000">)</font> <font color="#990000">%</font><font color="#990000">&gt;</font><br />     <font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> text_field <font color="#ff0000">'account'</font><font color="#990000">,</font> <font color="#ff0000">'login'</font><font color="#990000">,</font> <font color="#990000">:</font>id <font color="#990000">=</font><font color="#990000">&gt;</font> <font color="#ff0000">'account-new-login'</font> <font color="#990000">%</font><font color="#990000">&gt;</font><font color="#990000">&lt;</font>br <font color="#990000">/</font><font color="#990000">&gt;</font><br />     <font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> submit_tag <font color="#ff0000">'Login'</font> <font color="#990000">%</font><font color="#990000">&gt;</font><br />   <font color="#990000">&lt;</font><font color="#990000">%</font><font color="#990000">=</font> end_form_tag <font color="#990000">%</font><font color="#990000">&gt;</font> </pre>          <p>This will be the last time we're touch the Views. If you visit the page now, you should see a simple form. This is the most basic Rails app. It will be our mickey mouse app for this session:<br />   </p>             <p><a title="Photo Sharing" href="http://www.flickr.com/photos/choonkeat/165073750/"><img width="240" height="93" border="0" alt="KRJS walkthru: Default form" src="http://static.flickr.com/49/165073750_19cba41a79_m.jpg" /></a></p>             <p>Clicking on Login leads you to an even simpler error page:</p>           <p><a title="Photo Sharing" href="http://www.flickr.com/photos/choonkeat/165073835/"><img width="240" height="94" border="0" alt="KRJS walkthru: Default page after submitting form" src="http://static.flickr.com/64/165073835_c5d9f5608a_m.jpg" /></a></p>             <p>This is because we didn't have any code to handle the form submit. Don't let that stop us web2.0-ers, let's ajaxify it anyways! First, install the <a href="http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/">KRJS plugin</a> </p><pre><font color="#990000">.</font>/script/plugin install http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/</pre><p>and <strong>restart your server</strong>.</p>         <p>Now, try to view the page, and click on the Login button.... same error page. Good! That means KRJS didn't mess up the original app. Now let's add a new method into the controller, app/controllers/sample_controller.rb<br />     </p>         <pre>  <strong><font color="#0000ff">def</font></strong> on_form_submit<br />       render <font color="#990000">:</font>update <strong><font color="#0000ff">do</font></strong> <font color="#990000">|</font>page<font color="#990000">|</font><br />         page<font color="#990000">.</font>insert_html <font color="#990000">:</font>after<font color="#990000">,</font> <font color="#ff0000">'form'</font><font color="#990000">,</font> CGI<font color="#990000">.</font><strong><font color="#000000">escapeHTML</font></strong><font color="#990000">(</font>params<font color="#990000">.</font>inspect<font color="#990000">)</font><br />       <strong><font color="#0000ff">end</font></strong><br />     <strong><font color="#0000ff">end</font></strong></pre>   <p>&nbsp;</p>         <p>Refresh the page, and click on Login</p>         <p><a title="Photo Sharing" href="http://www.flickr.com/photos/choonkeat/165073881/"><img width="240" height="93" border="0" alt="KRJS walkthru: Result page after installing KRJS and clicking form" src="http://static.flickr.com/45/165073881_98a6576eac_m.jpg" /></a></p>         <p>As you can see, the form has become ajaxified - to update the page instead of sending the browser to a new location - by merely adding a new corresponding method in the controller! How about adding this to the controller:</p>       <p>&nbsp;</p>     <pre>  <strong><font color="#0000ff">def</font></strong> on_account_login_blur<br />       render <font color="#990000">:</font>update <strong><font color="#0000ff">do</font></strong> <font color="#990000">|</font>page<font color="#990000">|</font><br />         page<font color="#990000">.</font>insert_html <font color="#990000">:</font>after<font color="#990000">,</font> <font color="#ff0000">'form'</font><font color="#990000">,</font> CGI<font color="#990000">.</font><strong><font color="#000000">escapeHTML</font></strong><font color="#990000">(</font>params<font color="#990000">.</font>inspect<font color="#990000">)</font><br />       <strong><font color="#0000ff">end</font></strong><br />     <strong><font color="#0000ff">end</font></strong></pre>   <p>&nbsp;</p>       <p>Refresh the page, type something into the textfield and TAB away from the field:<br />   </p>       <p><a title="Photo Sharing" href="http://www.flickr.com/photos/choonkeat/165073907/"><img width="240" height="94" border="0" alt="KRJS walkthru: Result page after losing focus on text field" src="http://static.flickr.com/44/165073907_898d68f271_m.jpg" /></a></p>             <p>Yea, KRJS registers onBlur events as well. In fact, it'll register onClick, onSubmit, onWatever, onYouwant because it doesn't really care. All that matters is your HTML element's ID attribute. <a href="http://choonkeat.svnrepository.com/svn/rails-plugins/krjs/">KRJS</a> currently identifies xhr actions by naming conventions, hence it will probably be most convenient to be used with <a href="http://choonkeat.svnrepository.com/svn/rails-plugins/dashed_dom_id/">dashed_</a><a href="http://choonkeat.svnrepository.com/svn/rails-plugins/dashed_dom_id/">dom_id plugin</a>.&nbsp;</p>     <p>Go ahead, give it a spin. I'm going to sleep.. hope I don't wake into a world of horror... <br />   </p><p>[Updated plugin links]&nbsp;</p></p>


  </div><a class="u-url" href="/weblog/2006/06/krjs-rjs-withou.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The Devel!</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">choonkeat</li><li><a class="u-email" href="mailto:contactme@choonkeat.com">contactme@choonkeat.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/choonkeat"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">choonkeat</span></a></li><li><a href="https://www.twitter.com/choonkeat"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">choonkeat</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>choonkeat on programming &amp; software</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
